<div class="flex flex-col items-center w-full min-h-screen bg-[#EBEBEB] pb-20">
    <!-- Toolbar -->
    <div
        class="sticky top-0 z-30 w-full bg-white border-b border-slate-200 px-8 py-3 flex items-center justify-between shadow-sm">
        <div class="flex items-center gap-6">
            <div class="flex items-center gap-2 pr-6 border-r border-slate-200">
                <div class="bg-[#EB1000] p-1.5 rounded">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
                        stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
                        <polyline points="14 2 14 8 20 8" />
                    </svg>
                </div>
                <span class="font-bold text-slate-800 tracking-tight">Fello Sign</span>
            </div>
            <app-pdf-pager [currentPage]="currentPage" [totalPages]="totalPages"
                (onPageChange)="goToPage($event)"></app-pdf-pager>
        </div>

        <div class="flex items-center gap-3">
            <app-button variant="ghost" size="sm" (onClick)="onCancel.emit()"
                className="text-slate-500 hover:text-slate-800">
                Cancel
            </app-button>
            <app-button size="sm" (onClick)="onDownload.emit()" [disabled]="signatures.length === 0"
                className="px-6 rounded-full">
                Finish and Download
            </app-button>
        </div>
    </div>

    <!-- PDF Page Content -->
    <div class="w-full max-w-5xl px-4 flex justify-center py-10">
        <app-pdf-page-view [pageImage]="pageImage" [signatures]="currentPageSignatures" [isPlacing]="isPlacing"
            [isModalOpen]="isModalOpen" (onBoxDrawn)="handleBoxDrawn($event)"
            (onRemoveSignature)="onRemoveSignature.emit($event)"
            (onSignatureMoved)="onSignatureMoved.emit($event)"></app-pdf-page-view>
    </div>

    <!-- Floating Action Button for Placing -->
    <div class="fixed bottom-8 right-8 z-40 flex flex-col gap-3">
        <app-button *ngIf="!isPlacing" className="w-48 rounded-full py-4 shadow-xl hover:scale-105"
            (onClick)="onStartPlacing.emit('signature')">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                <path d="M12 20h9" />
                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z" />
            </svg>
            Add Signature
        </app-button>

        <app-button *ngIf="!isPlacing"
            className="w-48 bg-slate-900 hover:bg-black text-white rounded-full py-4 shadow-xl hover:scale-105"
            (onClick)="onStartPlacing.emit('text')">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2">
                <rect width="18" height="18" x="3" y="3" rx="2" />
                <path d="M7 12h10" />
                <path d="M10 8h4" />
                <path d="M10 16h4" />
            </svg>
            Add Text
        </app-button>

        <app-button *ngIf="isPlacing" variant="danger" className="w-48 rounded-full py-4 shadow-xl hover:scale-105"
            (onClick)="onCancelPlacing.emit()">
            Cancel Placing
        </app-button>
    </div>

    <!-- Floating Tooltip (Center) -->
    <div *ngIf="isPlacing" class="fixed bottom-8 left-1/2 -translate-x-1/2 z-40 pointer-events-none">
        <div
            class="bg-primary-600/95 text-white px-4 py-2 rounded-full text-xs font-bold shadow-2xl backdrop-blur-md border border-white/20 whitespace-nowrap animate-bounce">
            Click and drag to draw your signature box
        </div>
    </div>
</div>